<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="534px" preserveAspectRatio="none" style="width:914px;height:534px;" version="1.1" viewBox="0 0 914 534" width="914px" zoomAndPan="magnify"><defs><filter height="300%" id="f1w80rwk0qku8v" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[ca382112f6ba20bcbc6967caf2c628f5]
class FlyWeightFactory--><rect fill="#FEFECE" filter="url(#f1w80rwk0qku8v)" height="73.6094" id="FlyWeightFactory" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="306.5" y="128.5"/><ellipse cx="339.95" cy="144.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M342.9188,150.1406 Q342.3406,150.4375 341.7,150.5781 Q341.0594,150.7344 340.3563,150.7344 Q337.8563,150.7344 336.5281,149.0938 Q335.2156,147.4375 335.2156,144.3125 Q335.2156,141.1875 336.5281,139.5313 Q337.8563,137.875 340.3563,137.875 Q341.0594,137.875 341.7,138.0313 Q342.3563,138.1875 342.9188,138.4844 L342.9188,141.2031 Q342.2938,140.625 341.7,140.3594 Q341.1063,140.0781 340.4813,140.0781 Q339.1375,140.0781 338.45,141.1563 Q337.7625,142.2188 337.7625,144.3125 Q337.7625,146.4063 338.45,147.4844 Q339.1375,148.5469 340.4813,148.5469 Q341.1063,148.5469 341.7,148.2813 Q342.2938,148 342.9188,147.4219 L342.9188,150.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="105" x="358.05" y="148.6543">FlyWeightFactory</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="307.5" x2="483.5" y1="160.5" y2="160.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="142" x="312.5" y="174.7104">-flyWeightList: FlyWeight[]</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="307.5" x2="483.5" y1="181.3047" y2="181.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="166" x="312.5" y="195.5151">+getFlyWeight(key): FlyWeight</text><!--MD5=[396ab33e88ede6026b164a2817329d62]
class FlyWeight--><rect fill="#FEFECE" filter="url(#f1w80rwk0qku8v)" height="60.8047" id="FlyWeight" style="stroke: #A80036; stroke-width: 1.5;" width="309" x="285" y="277"/><ellipse cx="405.75" cy="293" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M401.6719,288.7656 L401.6719,286.6094 L409.0625,286.6094 L409.0625,288.7656 L406.5938,288.7656 L406.5938,296.8438 L409.0625,296.8438 L409.0625,299 L401.6719,299 L401.6719,296.8438 L404.1406,296.8438 L404.1406,288.7656 L401.6719,288.7656 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="59" x="426.25" y="297.1543">FlyWeight</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="286" x2="593" y1="309" y2="309"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="286" x2="593" y1="317" y2="317"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="297" x="291" y="331.2104">+operation(state: UnsharedConcreteFlyWeight): void</text><!--MD5=[3889509ddf6b9e109ccea120e7a4f2ff]
class ConcreteFlyWeight1--><rect fill="#FEFECE" filter="url(#f1w80rwk0qku8v)" height="86.4141" id="ConcreteFlyWeight1" style="stroke: #A80036; stroke-width: 1.5;" width="309" x="594" y="437"/><ellipse cx="682.25" cy="453" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M685.2188,458.6406 Q684.6406,458.9375 684,459.0781 Q683.3594,459.2344 682.6563,459.2344 Q680.1563,459.2344 678.8281,457.5938 Q677.5156,455.9375 677.5156,452.8125 Q677.5156,449.6875 678.8281,448.0313 Q680.1563,446.375 682.6563,446.375 Q683.3594,446.375 684,446.5313 Q684.6563,446.6875 685.2188,446.9844 L685.2188,449.7031 Q684.5938,449.125 684,448.8594 Q683.4063,448.5781 682.7813,448.5781 Q681.4375,448.5781 680.75,449.6563 Q680.0625,450.7188 680.0625,452.8125 Q680.0625,454.9063 680.75,455.9844 Q681.4375,457.0469 682.7813,457.0469 Q683.4063,457.0469 684,456.7813 Q684.5938,456.5 685.2188,455.9219 L685.2188,458.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="124" x="702.75" y="457.1543">ConcreteFlyWeight1</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="595" x2="902" y1="469" y2="469"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="600" y="483.2104">-key: string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="595" x2="902" y1="489.8047" y2="489.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="178" x="600" y="504.0151">ConcreteFlyWeight1(key: string)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="297" x="600" y="516.8198">+operation(state: UnsharedConcreteFlyWeight): void</text><!--MD5=[78b02b5db1009aab80b0b8fa90db206c]
class ConcreteFlyWeight2--><rect fill="#FEFECE" filter="url(#f1w80rwk0qku8v)" height="86.4141" id="ConcreteFlyWeight2" style="stroke: #A80036; stroke-width: 1.5;" width="309" x="6" y="437"/><ellipse cx="94.25" cy="453" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M97.2188,458.6406 Q96.6406,458.9375 96,459.0781 Q95.3594,459.2344 94.6563,459.2344 Q92.1563,459.2344 90.8281,457.5938 Q89.5156,455.9375 89.5156,452.8125 Q89.5156,449.6875 90.8281,448.0313 Q92.1563,446.375 94.6563,446.375 Q95.3594,446.375 96,446.5313 Q96.6563,446.6875 97.2188,446.9844 L97.2188,449.7031 Q96.5938,449.125 96,448.8594 Q95.4063,448.5781 94.7813,448.5781 Q93.4375,448.5781 92.75,449.6563 Q92.0625,450.7188 92.0625,452.8125 Q92.0625,454.9063 92.75,455.9844 Q93.4375,457.0469 94.7813,457.0469 Q95.4063,457.0469 96,456.7813 Q96.5938,456.5 97.2188,455.9219 L97.2188,458.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="124" x="114.75" y="457.1543">ConcreteFlyWeight2</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="314" y1="469" y2="469"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="12" y="483.2104">-key: string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="314" y1="489.8047" y2="489.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="178" x="12" y="504.0151">ConcreteFlyWeight2(key: string)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="297" x="12" y="516.8198">+operation(state: UnsharedConcreteFlyWeight): void</text><!--MD5=[2c209814a1f3945415e24b0de034c7c9]
class UnsharedConcreteFlyWeight--><rect fill="#FEFECE" filter="url(#f1w80rwk0qku8v)" height="73.6094" id="UnsharedConcreteFlyWeight" style="stroke: #A80036; stroke-width: 1.5;" width="209" x="350" y="443"/><ellipse cx="365" cy="459" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M367.9688,464.6406 Q367.3906,464.9375 366.75,465.0781 Q366.1094,465.2344 365.4063,465.2344 Q362.9063,465.2344 361.5781,463.5938 Q360.2656,461.9375 360.2656,458.8125 Q360.2656,455.6875 361.5781,454.0313 Q362.9063,452.375 365.4063,452.375 Q366.1094,452.375 366.75,452.5313 Q367.4063,452.6875 367.9688,452.9844 L367.9688,455.7031 Q367.3438,455.125 366.75,454.8594 Q366.1563,454.5781 365.5313,454.5781 Q364.1875,454.5781 363.5,455.6563 Q362.8125,456.7188 362.8125,458.8125 Q362.8125,460.9063 363.5,461.9844 Q364.1875,463.0469 365.5313,463.0469 Q366.1563,463.0469 366.75,462.7813 Q367.3438,462.5 367.9688,461.9219 L367.9688,464.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="177" x="379" y="463.1543">UnsharedConcreteFlyWeight</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="351" x2="558" y1="475" y2="475"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="25" x="356" y="489.2104">-info</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="351" x2="558" y1="495.8047" y2="495.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="356" y="510.0151">+setInfo(): void</text><path d="M520,115 L520,161.5 L484.5234,165.5 L520,169.5 L520,215.7969 A0,0 0 0 0 520,215.7969 L695,215.7969 A0,0 0 0 0 695,215.7969 L695,125 L685,115 L520,115 A0,0 0 0 0 520,115 " fill="#FBFB77" filter="url(#f1w80rwk0qku8v)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M685,115 L685,125 L695,125 L685,115 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="526" y="132.0669">if (!flyWeightList[key]) {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="534" y="147.1997">flyWeightList[key] =</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="542" y="162.3325">create new FlyWeight</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="526" y="177.4653">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="534" y="192.5981"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="526" y="207.731">return flyWeightList[key]</text><!--MD5=[ed6624c6556d5e7b1bd23032162d20b7]
class Client--><rect fill="#FEFECE" filter="url(#f1w80rwk0qku8v)" height="48" id="Client" style="stroke: #A80036; stroke-width: 1.5;" width="67" x="362" y="6"/><ellipse cx="377" cy="22" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M379.9688,27.6406 Q379.3906,27.9375 378.75,28.0781 Q378.1094,28.2344 377.4063,28.2344 Q374.9063,28.2344 373.5781,26.5938 Q372.2656,24.9375 372.2656,21.8125 Q372.2656,18.6875 373.5781,17.0313 Q374.9063,15.375 377.4063,15.375 Q378.1094,15.375 378.75,15.5313 Q379.4063,15.6875 379.9688,15.9844 L379.9688,18.7031 Q379.3438,18.125 378.75,17.8594 Q378.1563,17.5781 377.5313,17.5781 Q376.1875,17.5781 375.5,18.6563 Q374.8125,19.7188 374.8125,21.8125 Q374.8125,23.9063 375.5,24.9844 Q376.1875,26.0469 377.5313,26.0469 Q378.1563,26.0469 378.75,25.7813 Q379.3438,25.5 379.9688,24.9219 L379.9688,27.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="391" y="26.1543">Client</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="363" x2="428" y1="38" y2="38"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="363" x2="428" y1="46" y2="46"/><!--MD5=[ee9f992e01c26430759878085ec47776]
reverse link FlyWeight to ConcreteFlyWeight1--><path d="M609.8066,343.2582 C637.1269,351.0124 660.3949,359.4614 672.5,368 C696.9827,385.2694 715.9302,413.1186 728.7831,436.7253 " fill="none" id="FlyWeight&lt;-ConcreteFlyWeight1" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="607.8212,349.973,590.3326,338.0084,611.4653,336.4555,607.8212,349.973" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[e392d878ec662c946ed6dc57e54c8e69]
reverse link FlyWeight to ConcreteFlyWeight2--><path d="M372.6615,348.8249 C329.6514,375.4172 273.8575,409.9134 230.281,436.8558 " fill="none" id="FlyWeight&lt;-ConcreteFlyWeight2" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="369.2495,342.7046,389.9419,338.1408,376.6119,354.6124,369.2495,342.7046" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[6430a02900d064084262b241c08dcd9a]
link Client to FlyWeightFactory--><path d="M395.5,54.2247 C395.5,73.4033 395.5,100.6517 395.5,123.3839 " fill="none" id="Client-&gt;FlyWeightFactory" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="395.5,128.4586,399.5,119.4586,395.5,123.4586,391.5,119.4586,395.5,128.4586" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[07e01ea287dd22b214b134c357090bdf]
reverse link FlyWeightFactory to FlyWeight--><path d="M410.9737,215.4378 C417.2942,235.8358 424.4049,258.784 429.9459,276.6662 " fill="none" id="FlyWeightFactory&lt;-FlyWeight" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="407.0605,202.8088,405.0156,209.7239,410.6122,214.2711,412.6571,207.3561,407.0605,202.8088" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[67f1e4c7a457beaa3b38fca22bc853f4]
reverse link FlyWeight to UnsharedConcreteFlyWeight--><path d="M442.6418,343.6305 C445.1714,372.7212 448.714,413.4607 451.2674,442.8255 " fill="none" id="FlyWeight&lt;-UnsharedConcreteFlyWeight" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="442.1817,338.3395,438.9766,347.6523,442.615,343.3207,446.9466,346.959,442.1817,338.3395" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M452.5,373 L452.5,398 L655.5,398 L655.5,383 L645.5,373 L452.5,373 " fill="#FBFB77" filter="url(#f1w80rwk0qku8v)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M645.5,373 L645.5,383 L655.5,383 L645.5,373 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="458.5" y="390.0669">不能共享的部分注入到共享类中</text><!--MD5=[17e5c130bc3fc3426d819855e1355deb]
link Client to ConcreteFlyWeight1--><path d="M429.0787,34.1854 C502.8915,44.1113 675.638,71.5514 712.5,115 C788.6845,204.7976 773.5827,355.342 759.3287,431.9994 " fill="none" id="Client-&gt;ConcreteFlyWeight1" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="758.392,436.9404,763.9986,428.8431,759.3234,432.0279,756.1386,427.3528,758.392,436.9404" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[24a56aeb4eb842e2f43cd27133532d8e]
link Client to ConcreteFlyWeight2--><path d="M361.7061,49.9535 C338.5255,65.1743 308.616,88.0708 289.5,115 C218.5498,214.9493 183.2204,357.7317 168.7673,431.5941 " fill="none" id="Client-&gt;ConcreteFlyWeight2" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="167.7626,436.7916,173.3981,428.7144,168.7116,431.8825,165.5436,427.196,167.7626,436.7916" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[9ed73a7e02703ae17a6dbb17be9c7c74]
@startuml 享元模式
skinparam classAttributeIconSize 0

class FlyWeightFactory {
  -flyWeightList: FlyWeight[]
  + getFlyWeight(key): FlyWeight
}
interface FlyWeight {
  + operation(state: UnsharedConcreteFlyWeight): void
}
class ConcreteFlyWeight1 implements FlyWeight {
  - key: string
  ConcreteFlyWeight1(key: string)
  + operation(state: UnsharedConcreteFlyWeight): void
}
class ConcreteFlyWeight2 implements FlyWeight {
  - key: string
  ConcreteFlyWeight2(key: string)
  + operation(state: UnsharedConcreteFlyWeight): void
}
class UnsharedConcreteFlyWeight {
  - info
  + setInfo(): void
}

note as N1
if (!flyWeightList[key]) {
  flyWeightList[key] =
    create new FlyWeight
}
  
return flyWeightList[key]
end note

Client - -> FlyWeightFactory
FlyWeightFactory o- - FlyWeight
FlyWeightFactory <- N1
FlyWeight <.. UnsharedConcreteFlyWeight
note right on link 
不能共享的部分注入到共享类中
end note
Client - -> ConcreteFlyWeight1
Client - -> ConcreteFlyWeight2

@enduml

PlantUML version 1.2020.12(Sat Jun 06 10:54:15 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>